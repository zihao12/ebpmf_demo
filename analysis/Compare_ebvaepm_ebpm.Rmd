---
title: "Compare_ebvaepm_ebpm"
author: "zihao12"
date: "2019-10-23"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

```{r}
devtools::load_all("../ebpm")
library(ggplot2)
library(reticulate)
use_python("/anaconda3/bin")
py_config()

```

## show VAE results
```{r}
vae_out = py_load_object("data/poisson-normal.pkl", pickle = "pickle")
vae_out = data.frame(vae_out)


ggplot(vae_out)+
  geom_histogram(aes(x = x))

ggplot(vae_out)+
  geom_point(aes(x = x, y = posterior_vae))
```

## Compare with EBPM
```{r warning=F}
library(ebpm)
fit_ebpm = ebpm_exponential_mixture(as.vector(vae_out$x), s = 1, m = 2^0.25)
vae_out[["posterior_ebpm"]] = fit_ebpm$posterior$mean
ggplot(vae_out)+
  geom_point(aes(x = x, y = posterior_ebpm))
```


```{r}
## biggest weight
max(fit_ebpm$fitted_g$pi)
## the mean  of the exponential component corresponding to the biggest weight
fit_ebpm$fitted_g$scale[which.max(fit_ebpm$fitted_g$pi)]
```

